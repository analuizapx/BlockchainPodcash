<!DOCTYPE html>
<html>
<head>
	<title>PodCash</title>
	<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.min.js"></script>
	<script type="text/javascript">
		const contract_address = "0x0a5b5e5f6041d1d4ff7886c21ac328f4e65db50e";

		const contract_abi = [
	{
		"inputs": [],
		"name": "apoiar",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "setSuaContribuicao",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "transfereAutor",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [],
		"name": "getAutor",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getDescricao",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getMes",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getSuaContribuicao",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getvalorArrecadado",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];
		

		const ethEnabled = () => {
		  if (window.ethereum) {
		    window.web3 = new Web3(window.ethereum);
		    window.ethereum.enable();
		    return true;
		  }
		  return false;
		}
		
		async function saveCoinbase () {
		  window.coinbase = await window.web3.eth.getCoinbase();
		};
		
		async function setApoiar () {
                	var val = document.getElementById("apoiar").value;
        		window.contratoPodCash.methods.apoiar().send({from:window.coinbase, to: contract_address, value: val});
		}
		
		async function getAndShowApoio(){
			window.contratoPodCash.methods.setSuaContribuicao().send({from:window.coinbase});
			var val=window.contratoPodCash.methods.getSuaContribuicao().call();
			document.getElementById("cont").value = await val;
			console.log(val);
		}
		
		async function getAndShowValorArrecadado(){
			var val=window.contratoPodCash.methods.getvalorArrecadado().call();
			document.getElementById("arrec").value = await val;
			console.log(val);
		}
		
		async function transfereDono(){
			window.contratoPodCash.methods.transfereAutor().send({from:window.coinbase})
		}

	

		if (!ethEnabled()) {
		  alert("Metamask or browser with Ethereum not detected!");
		}
		else {
			window.contratoPodCash = new web3.eth.Contract(contract_abi, contract_address);
			saveCoinbase();
		}

	</script>
</head>
<body>
	<button id="getme" onclick="setApoiar()">Apoiar</button>
	<br/>
	Valor: <input type="text" name="apoiar" id="apoiar"> wei
	<br/>
	<button id="setme" onclick="getAndShowApoio()">Sua contribuição </button>
	<br/>
	Valor: <input type="text" name="cont" id="cont"> wei
	<br/>
	<button id="setme2" onclick="getAndShowValorArrecadado()">Total arrecadado: </button>
	Valor: <input type="text" name="arrec" id="arrec"> wei
	<br/>
	<button id="setme3" onclick="transfereDono()">Transfere para autor </button>
	<br/>
	
	<div class="podcast-player"><div class="podcast-player-inner-wrap"><!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
<span class="mejs-offscreen">Tocador de áudio</span><div id="mep_0" class="mejs-container mejs-container-keyboard-inactive wp-audio-shortcode mejs-audio" tabindex="0" role="application" aria-label="Tocador de áudio" style="width: 552.5px; height: 40px; min-width: 281px;"><div class="mejs-inner"><div class="mejs-mediaelement"><mediaelementwrapper id="audio-43069-1"><audio class="wp-audio-shortcode" id="audio-43069-1_html5" preload="none" style="width: 100%; height: 100%;" src="https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3?_=1"><source type="audio/mpeg" src="https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3?_=1"><a href="https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3" onclick="javascript:window.open('https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3'); return false;">https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3</a></audio></mediaelementwrapper></div><div class="mejs-layers"><div class="mejs-poster mejs-layer" style="display: none; width: 100%; height: 100%;"></div></div><div class="mejs-controls"><div class="mejs-button mejs-playpause-button mejs-play"><button type="button" aria-controls="mep_0" title="Reproduzir" aria-label="Reproduzir" tabindex="0"></button></div><div class="mejs-time mejs-currenttime-container" role="timer" aria-live="off"><span class="mejs-currenttime">00:00</span></div><div class="mejs-time-rail"><span class="mejs-time-total mejs-time-slider" role="slider" tabindex="0" aria-label="Tempo do slider" aria-valuemin="0" aria-valuemax="0" aria-valuenow="0" aria-valuetext="00:00"><span class="mejs-time-buffering" style="display: none;"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-hovered no-hover"></span><span class="mejs-time-handle"><span class="mejs-time-handle-content"></span></span><span class="mejs-time-float" style="display: none; left: 0px;"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div><div class="mejs-time mejs-duration-container"><span class="mejs-duration">00:00</span></div><div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="mep_0" title="Mudo" aria-label="Mudo" tabindex="0"></button></div><a class="mejs-horizontal-volume-slider" href="javascript:void(0);" aria-label="Controle de volume" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" role="slider" style="display: block;"><span class="mejs-offscreen">Use as setas para cima ou para baixo para aumentar ou diminuir o volume.</span><div class="mejs-horizontal-volume-total"><div class="mejs-horizontal-volume-current" style="left: 0px; width: 100%;"></div><div class="mejs-horizontal-volume-handle" style="left: 100%;"></div></div></a></div></div></div><a class="download-link" download="" href="https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3" onclick="javascript:window.open('https://anchor.fm/s/910f53c/podcast/play/21746703/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-9-28%2F7bdc4a58-dd7f-423a-d4eb-d9c39515a9c9.mp3'); return false;"><span class="mejs-offscreen">Download</span></a></div></div>
</body>
</html>
